---
title: "Sequence Search Analysis Writeup (E2 & combined analysis)"
author: Mona Zhu
date: Updated June 19, 2019
output: 
  html_document:
    fig_width: 8
    fig_height: 5
    fig.align: center
    toc: true
    toc_float: true
    theme: cerulean
    highlight: tango
    code_folding: hide
---

  <style>
  pre code, pre, code {
    overflow-y: auto !important;
    max-height: 20em;
  }
</style>

```{r}
knitr::opts_chunk$set(warning=FALSE, message = FALSE)
```

```{r}
# load libraries
# tidying data
library(reshape2)
library(sjPlot)

# plotting
library(ggplot2)
library(car)
library(plyr)
library(wesanderson)

# analyses
library(lme4)
library(ez)
```

```{r}
# Importing data
# setwd("C:/Users/Grayden Solman/Desktop/Mona/Sequenced Search")
setwd("C:/Users/MonaZhu/Dropbox/Grayden/Sequenced Search")
# setwd("//fileu/users$/jhzhu/Desktop/Sequenced Search")
raw1a<-read.table("summary_firstHalf.txt", sep="\t", header=T)
raw1a$Experiment<-"E1a"
raw1b<-read.table("summary_secondHalf.txt", sep="\t", header=T)
raw1b$Experiment<-"E1b"
raw2<-read.table("summary.txt", sep="\t", header=T)
raw2$Experiment<-"E2"

df<-rbind(raw1a, raw1b, raw2)

# Item Level Data
rawi1a<-read.table("summaryByItems_firstHalf.txt", sep="\t", header=T)
rawi1a$Experiment<-"E1a"
rawi1b<-read.table("summaryByItems_secondHalf.txt", sep="\t", header=T)
rawi1b$Experiment<-"E1b"
rawi2<-read.table("summaryByItems.txt", sep="\t", header=T)
rawi2$Experiment<-"E2"

item<-rbind(rawi1a, rawi1b, rawi2)

# Creating additional variables
df$SUBJECT<-factor(paste0(df$SUBJECT,df$Experiment))
df$Organization<-factor(ifelse(df$NUM_ORG_MOVES==0, "No", "Yes"))
df$Org.Num<-ifelse(df$NUM_ORG_MOVES==0, 0, 1)
df$SeqType<-factor(ifelse(df$SEQ_LEN<5, "Short", "Long"))
df$SeqType<-factor(df$SeqType, levels(df$SeqType)[c(2,1)])
df$PrepTime<-(df$SEARCH_START_TIME-df$TRIAL_START_TIME)/1000
df$SearchTimeTotal<-(df$SEARCH_COMPLETION_TIME-df$SEARCH_START_TIME)/1000
df$SearchTimeAvg<-df$SearchTimeTotal/df$SEQ_LEN
df$Repetition<-df$SEQ_LEN/df$NUM_UNIQUE_IN_SEQ

e1a<-subset(df, Experiment=="E1a")
e1a$uniq.c <- e1a$NUM_UNIQUE_IN_SEQ - mean(e1a$NUM_UNIQUE_IN_SEQ)
e1a$rep.c<-e1a$Repetition - mean(e1a$Repetition)
e1a$trial.c<-e1a$TRIAL - mean(e1a$TRIAL)

e1b<-subset(df, Experiment=="E1b")
e1b$uniq.c <- e1b$NUM_UNIQUE_IN_SEQ - mean(e1b$NUM_UNIQUE_IN_SEQ)
e1b$rep.c<-e1b$Repetition - mean(e1b$Repetition)
e1b$trial.c<-e1b$TRIAL - mean(e1b$TRIAL)


e2<-subset(df, Experiment=="E2")
e2$uniq.c <- e2$NUM_UNIQUE_IN_SEQ - mean(e2$NUM_UNIQUE_IN_SEQ)
e2$rep.c<-e2$Repetition - mean(e2$Repetition)
e2$trial.c<-e2$TRIAL - mean(e2$TRIAL)


# other data organization
moved<-subset(df, Organization=="Yes")
df.moved<-melt(moved, id=c(1:5,7,9:20))
names(df.moved)[c(19, 20)]=c("Arrangement", "Distance")
df.moved$Arrangement<-factor(recode(df.moved$Arrangement,"'AVG_TARG_DIST'='Pre-Organization';
                           'POST_ORG_AVG_TARG_DIST'='Post-Organization'"))
unmoved<-subset(df, Organization=="No")
df.unmoved<-melt(unmoved, id=c(1:5,7,9:20))
df.unmoved2<-subset(df.unmoved, variable=="AVG_TARG_DIST")
names(df.unmoved2)[c(19, 20)]=c("Arrangement", "Distance")
df.unmoved2$Arrangement<-factor(recode(df.unmoved2$Arrangement,"'AVG_TARG_DIST'='Unorganized'"))

df.org<-rbind(df.moved, df.unmoved2)

df.org$Arrangement<-factor(df.org$Arrangement, levels(df.org$Arrangement)[c(3,2,1)])

e1a.org<-subset(df.org, Experiment=="E1a")
e1a.org$uniq.c <- e1a.org$NUM_UNIQUE_IN_SEQ - mean(e1a.org$NUM_UNIQUE_IN_SEQ)
e1a.org$rep.c<-e1a.org$Repetition - mean(e1a.org$Repetition)
e1a.org$trial.c<-e1a.org$TRIAL - mean(e1a.org$TRIAL)

e1b.org<-subset(df.org, Experiment=="E1b")
e1b.org$uniq.c <- e1b.org$NUM_UNIQUE_IN_SEQ - mean(e1b.org$NUM_UNIQUE_IN_SEQ)
e1b.org$rep.c<-e1b.org$Repetition - mean(e1b.org$Repetition)
e1b.org$trial.c<-e1b.org$TRIAL - mean(e1b.org$TRIAL)

e2.org<-subset(df.org, Experiment=="E2")
e2.org$uniq.c <- e2.org$NUM_UNIQUE_IN_SEQ - mean(e2.org$NUM_UNIQUE_IN_SEQ)
e2.org$rep.c<-e2.org$Repetition - mean(e2.org$Repetition)
e2.org$trial.c<-e2.org$TRIAL - mean(e2.org$TRIAL)


# Cleaning Up Item level data
item$SUBJECT<-factor(paste0(item$SUBJECT, item$Experiment))
item$Movement<-factor(ifelse(item$AVG_TARG_DIST==item$POST_ORG_AVG_TARG_DIST, "Unmoved", "Moved"))
item$Movement<-factor(item$Movement, levels(item$Movement)[c(2,1)])
item$Move.Num<-ifelse(item$AVG_TARG_DIST==item$POST_ORG_AVG_TARG_DIST, 0, 1)
item$SeqType<-factor(ifelse(item$SEQ_LEN<5, "Short", "Long"))
item$SeqType<-factor(item$SeqType, levels(item$SeqType)[c(2,1)])
item$Repetition<-item$SEQ_LEN/item$NUM_UNIQUE_IN_SEQ

item1a<-subset(item, Experiment=="E1a")
item1a$uniq.c <- item1a$NUM_UNIQUE_IN_SEQ - mean(item1a$NUM_UNIQUE_IN_SEQ)
item1a$rep.c<-item1a$Repetition - mean(item1a$Repetition)
item1a$trial.c<-item1a$TRIAL - mean(item1a$TRIAL)

item1b<-subset(item, Experiment=="E1b")
item1b$uniq.c <- item1b$NUM_UNIQUE_IN_SEQ - mean(item1b$NUM_UNIQUE_IN_SEQ)
item1b$rep.c<-item1b$Repetition - mean(item1b$Repetition)
item1b$trial.c<-item1b$TRIAL - mean(item1b$TRIAL)

item2<-subset(item, Experiment=="E2")
item2$uniq.c <- item2$NUM_UNIQUE_IN_SEQ - mean(item2$NUM_UNIQUE_IN_SEQ)
item2$rep.c<-item2$Repetition - mean(item2$Repetition)
item2$trial.c<-item2$TRIAL - mean(item2$TRIAL)


moved<-subset(item, Movement=="Moved")
item.moved<-melt(moved, id=c(1:6, 8, 10:14))
names(item.moved)[c(13, 14)]=c("Arrangement", "Distance")
item.moved$Arrangement<-factor(recode(item.moved$Arrangement,"'AVG_TARG_DIST'='Pre-Movement';
                           'POST_ORG_AVG_TARG_DIST'='Post-Movement'"))
unmoved<-subset(item, Movement=="Unmoved")
item.unmoved<-melt(unmoved, id=c(1:6, 8, 10:14))
item.unmoved2<-subset(item.unmoved, variable=="AVG_TARG_DIST")
names(item.unmoved2)[c(13, 14)]=c("Arrangement", "Distance")
item.unmoved2$Arrangement<-factor(recode(item.unmoved2$Arrangement,"'AVG_TARG_DIST'='Unmoved'"))

item.org<-rbind(item.moved, item.unmoved2)

item.org$Arrangement<-factor(item.org$Arrangement, levels(item.org$Arrangement)[c(3,2,1)])

item1a.org<-subset(item.org, Experiment=="E1a")
item1a.org$uniq.c <- item1a.org$NUM_UNIQUE_IN_SEQ - mean(item1a.org$NUM_UNIQUE_IN_SEQ)
item1a.org$rep.c<-item1a.org$Repetition - mean(item1a.org$Repetition)
item1a.org$trial.c<-item1a.org$TRIAL - mean(item1a.org$TRIAL)


item1b.org<-subset(item.org, Experiment=="E1b")
item1b.org$uniq.c <- item1b.org$NUM_UNIQUE_IN_SEQ - mean(item1b.org$NUM_UNIQUE_IN_SEQ)
item1b.org$rep.c<-item1b.org$Repetition - mean(item1b.org$Repetition)
item1b.org$trial.c<-item1b.org$TRIAL - mean(item1b.org$TRIAL)

item2.org<-subset(item.org, Experiment=="E2")
item2.org$uniq.c <- item2.org$NUM_UNIQUE_IN_SEQ - mean(item2.org$NUM_UNIQUE_IN_SEQ)
item2.org$rep.c<-item2.org$Repetition - mean(item2.org$Repetition)
item2.org$trial.c<-item2.org$TRIAL - mean(item2.org$TRIAL)

```



# E2

## Introduction 

The results in E1 seem to indicate that individuals' decisions were influenced more so by the length of the target sequence participants were presented with. However, given that there were only ever 2-4 unique items in a sequence, it is plausible that individuals were using information such as the number of repeated searches for a single item, rather than the actual number of items in a sequence, to base their decision on. As such, the purpose of E2 is largly to determine whether individualsâ€™ tendency to organize their space is a result of sequence length or due to the number of times a unique item is repeatedly use (or both)

The setup of E2 is the same as E1 except: 

* Individual sequences are either 4 or 8 targets long 
* Each sequence can have 1, 2, 4 (for 4-item target sequences) or 2, 4, 8 (for 8-item target seqences) unique targets

## Analyses

### Performance: Response Time

#### How much time did participants spent during the pre-search phase of the task?


```{r}
graph1<-ddply(e2, .(SUBJECT, SeqType, Organization, Repetition), summarize, 
              mean=mean(PrepTime)
              )

graph2<-ddply(graph1, .(SeqType, Organization, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))
# print(graph2)

graph2$Repetition<-factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=Organization, shape=SeqType, linetype=SeqType, group=interaction(Organization, SeqType)))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16, 1))+
  ggtitle("pre-search task time as a function of sequence type + \nunqiue items in seq + whether items were organized")+
  scale_colour_manual(values=wes_palette(n=2, name="Moonrise2"))+
  scale_x_discrete("Number of Repeated Items in Sequence")+
  scale_y_continuous("Pre-Search Task Time (seconds)", breaks=seq(0, 50, 5))

```

```{r}
e2<-within(e2, Organization <- relevel(Organization, ref = 1))

pre.rt.mod<-lmer(PrepTime~SeqType*Organization*rep.c+(1|SUBJECT), data = e2, REML=F, na.action="na.omit",
                 contrasts=list(SeqType="contr.sum", Organization="contr.sum"))
tab_model(pre.rt.mod, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# 3-way interaction, split on organization
pre.rt.mod2<-lmer(PrepTime~SeqType*rep.c+(1|SUBJECT), data = e2[e2$Organization=="No",], REML=F,
                  na.action="na.omit", contrasts=list(SeqType="contr.sum"))
pre.rt.mod3<-lmer(PrepTime~SeqType*rep.c+(1|SUBJECT), data = e2[e2$Organization=="Yes",], REML=F,
                  na.action="na.omit",contrasts=list(SeqType="contr.sum"))
tab_model(pre.rt.mod2, pre.rt.mod3, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# spliting the seq length * repetition interaction for the organized trials
pre.rt.mod4<-lmer(PrepTime~rep.c+(1|SUBJECT), data = e2[e2$Organization=="Yes" & e2$SeqType=="Short",], 
                  REML=F, na.action="na.omit")
pre.rt.mod5<-lmer(PrepTime~rep.c+(1|SUBJECT), data = e2[e2$Organization=="Yes" & e2$SeqType=="Long",], 
                  REML=F, na.action="na.omit")
tab_model(pre.rt.mod4, pre.rt.mod5, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

Individuals spend less time prior to the search phase of the task if they chose not to organize their environment than if they did (b = -6.60, 95% CI [-7.10 -6.09], t = 25.45, p < .001).

Individuals spent less time when encountered with short than long search sequences (b = -2.34, 95% CI [-2.71, -1.97], t = 12.49, p < .001).

An increase in the number of repeated items was associated with a decrease in time spent prior to the search phase of the task (b = -2.96, 95% CI [-3.26, -2.67], t = 19.70, p < .001)

All two-way interactions were significant (all p < .001). More important, there was a significant three-way interaction (b = -.95, 95% CI [-1.24, -.65], t = 6.26, p < .001). When participants did not organize their environment, time spent in the pre-search pahse of the task differed as a function of sequence length (b = -.15, 95% CI [-.27, -.03], t = 2.52, p = .01) as well as repetition (b = -.15, 95% CI [-.24, -.05], t = 3.11, p < .001). However, the interaction was not significant (b = .02, 95% CI [-.07, .12], t = .47, p = .64). On the other hand, when participants did organize their envirionment, there was a significant two-way interaction between sequence length and number of repeated items (b = 1.96, 95% CI [1.39, 2.54], t = 6.75, p < .001) in addition to a main effect of sequence length (b = -4.61, 95% CI [-5.32, -3.91], t = 12.88, p < .001) and repetition (b = -5.80, 95% CI [-6.37, -5.23], t = 19.95, p < .001). Specifically, although there was a negative relation between time spent and repetition length overall, this relation was significantly steeper on trials with long search sequences (b = -7.74, 95% CI [-8.59, -6.89], t = 17.89, p < .001) than short ones (b = -3.70, 95% CI [-4.45, -2.96], t = 9.74, p < .001).




#### Does average search time differ as a function of sequence type 

```{r}
graph1<-ddply(e2, .(SUBJECT, SeqType, Organization, Repetition), summarize, 
              mean=mean(SearchTimeAvg)
              )

graph2<-ddply(graph1, .(SeqType, Organization, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=Organization, shape=SeqType, linetype=SeqType, group=interaction(Organization, SeqType)))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16, 1))+
  ggtitle("average search time per target item as a function of sequence type + \nunqiue items in seq + whether items were organized")+
  scale_colour_manual(values=wes_palette(n=2, name="Moonrise2"))+
  scale_x_discrete("Number of Repeated Items in Sequence")+
  scale_y_continuous("Average Search Time Per Target Item (seconds)", breaks=seq(0, 10, 0.5), limits=c(0, 2.7))

```

```{r}
post.rt.mod<-lmer(SearchTimeAvg~SeqType*Organization*rep.c+(1|SUBJECT), data = e2, REML=F, na.action="na.omit",
                  contrasts=list(SeqType="contr.sum", Organization="contr.sum"))
tab_model(post.rt.mod, transform = NULL, show.stat = T, p.val = "wald", digits = 3, digits.p = 2)

# 3 way interaction split on organization
post.rt.mod2<-lmer(SearchTimeAvg~SeqType*rep.c+(1|SUBJECT), data = e2[e2$Organization=="Yes",], 
                   REML=F, na.action="na.omit", contrasts = list(SeqType="contr.sum"))
post.rt.mod3<-lmer(SearchTimeAvg~SeqType*rep.c+(1|SUBJECT), data = e2[e2$Organization=="No",], 
                   REML=F, na.action="na.omit", contrasts = list(SeqType="contr.sum"))
tab_model(post.rt.mod2, post.rt.mod3, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# breaking down previous two-way interaction
post.rt.mod4<-lmer(SearchTimeAvg~rep.c+(1|SUBJECT), data = e2[e2$Organization=="No" & e2$SeqType=="Short",],
                   REML=F, na.action="na.omit")
post.rt.mod5<-lmer(SearchTimeAvg~rep.c+(1|SUBJECT), data = e2[e2$Organization=="No" & e2$SeqType=="Long",],
                   REML=F, na.action="na.omit")
tab_model(post.rt.mod4, post.rt.mod5, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

When individuals did not organized the task environment prior to search, they spend more time searching for each target item on average than trials where they organize the environment (b = .20, 95% CI [.18, .23], t = 14.93, p < .001).

Overall, it takes individuals less time to search for each target when they are presented in a short sequence than a long one (b = -.11, 95% CI [-.13, -.10], t = 12.10, p < .001).

As the number of times that items are repeated increased, the amount of time spent searching per target decreased (b = -.17, 95% CI [-.18, -.15], t = 22.17, p < .001).

There was a two-way interaction between sequence length and repetition length (b = -.02, 95% CI [-.04, -.01], t = 2.69, p = .01). 

There was also a two-way interaction between choice to organize and repetition length (b = -.04, 95% CI [-.05, -.02], t = 4.76, p < .001).

Importantly, there was a three-way interaction (b = -.02, 95% CI [-.03, -.002] t = 2.27, p = .02). When participants engaged in organization, it took less time to search for items on trials with short sequences than long ones (b = .13, 95% CI [-.14, -.11], t = 13.59, p < .001) and decreased with increased repetition length (b = -.13, 95% CI [-.14, -.12], t = 17.41, p < .001). On the other hand, though these same main effects emerged when individuals did not engage in organization, these main effects were qualified by a two-way interaction between sequence and repetition length (b = -.04, 95% CI [-.07, -.02], t = 3.37, p < .001). While both types of sequence length resulted in a negative relation between time spend per item during search, this relation was steeper for short sequences (b = -.24, 95% CI [-.28, -.20], t = 11.54, p < .001) than long ones (b = .16, 95% CI [-.19, -.13], t = 10.26, p < .001).



### Organizational Moves: Trial-Level Organization

#### Did decision to organize (Y/N) change as a function of sequence type? 

```{r}
graph1<-ddply(e2, .(SUBJECT, SeqType, Repetition), summarize, 
              mean=mean(Org.Num)
              )

graph2<-ddply(graph1, .(SeqType, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=SeqType, group=SeqType))+
  geom_point(size=3, shape=16, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  ggtitle("choice to organize as a function of sequence type + unique target in seq")+
  geom_hline(yintercept = 0.5, linetype="dotted")+
  scale_colour_manual("Sequence\nLength", values=wes_palette("Moonrise3", n=2))+
  scale_x_discrete("Repetition Length")+
  scale_y_continuous("Proportion of Trials Where Organization Occured", limits=c(0, 1))
```

```{r}
moves.mod<-glmer(Org.Num ~ SeqType*rep.c + (1 | SUBJECT), data = e2, family = binomial,
                 contrasts = list (SeqType="contr.sum")) 
tab_model(moves.mod, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# two-way interaction
moves.mod2<-glmer(Org.Num ~ rep.c + (1 | SUBJECT), data = e2[e2$SeqType=="Short",], family = binomial) 
moves.mod3<-glmer(Org.Num ~ rep.c + (1 | SUBJECT), data = e2[e2$SeqType=="Long",], family = binomial) 
tab_model(moves.mod2, moves.mod3, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

```

Overall, sequence length was not a significant predictor of participants' likelihood to engage in organization (b = -.03, 95% CI [-.18, .12], z = .44, p = .66).

As repetition length increased, likelihood of engaging in organization decreased (b = -.16, 95% CI [-.28, -.04], t= 2.62, p = .01). 

However, this was quantified by a significant two-way interaction between repetition and sequence length (b = -.35, 95% CI [-.48, -.23], z = 5.61, p < .001). That is, when participants are shown short target sequences, their tendency to organize the task environment decreases with repetition (b = -.51, 95% CI [.69, -.33], z = 5.58, p < .001). However, when shown long sequence lengths, individuals were more likely to organize their environments with increased repetition length (b = .2, 95% CI [.03, .37], z = 2.30, p = .02).




#### Decision to Organize (Y/N) as a function of sequence type across time {.tabset}

##### Overall

```{r}
graph1<-ddply(e2, .(SUBJECT, SeqType, TRIAL), summarize, 
              mean=mean(Org.Num)
              )

graph2<-ddply(graph1, .(SeqType, TRIAL), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

ggplot(graph2, aes(x=TRIAL, y=dep.avg, colour=SeqType))+
  geom_point(size=3, shape=16, alpha = .6, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  ggtitle("proportion individuals chose to organize task space as a function of \nsequence type")+
  # geom_vline(xintercept = 6, linetype="dotted")+
  scale_colour_manual("Sequence\nLength", values=wes_palette("Moonrise3", n=2))+
  scale_x_continuous("Trials")+
  scale_y_continuous("Proportion of Trials Where Organization Occured", limits=c(0, 1.49))

```


##### Faceted on Repetition Length

```{r, fig.height = 9, fig.width = 8}
graph1<-ddply(e2, .(SUBJECT, SeqType, TRIAL, Repetition), summarize, 
              mean=mean(Org.Num)
              )

graph2<-ddply(graph1, .(SeqType, TRIAL, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=TRIAL, y=dep.avg, colour=SeqType))+
  geom_point(size=3, shape=16, alpha = .6, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  facet_grid(Repetition~.)+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  ggtitle("proportion individuals chose to organize task space as a function of \nsequence type")+
  # geom_vline(xintercept = 6, linetype="dotted")+
  scale_colour_manual("Sequence\nLength", values=wes_palette("Moonrise3", n=2))+
  scale_x_continuous("Trials")+
  scale_y_continuous("Proportion of Trials Where Organization Occured", limits=c(0, 1.49))

```


####

```{r, warning=T}
moves.mod4<-glmer(Org.Num ~ trial.c*SeqType*rep.c+(1|SUBJECT), data = e2, family = binomial(link = logit),
                  contrasts=list(SeqType="contr.sum")) 
tab_model(moves.mod4, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```


When number of trials was added to the model, it was negatively associated with individuals' likelihood to organize their task environments (b = -.05, 95% CI [-.06, -.04], t = 7.88, p < .001). No additional factors or interactions were significant (all p > .09)



#### Item Location (Tria)

```{r}
graph1<-ddply(e2.org, .(SUBJECT, Arrangement, SeqType, Repetition), summarize, 
              mean=mean(Distance)
              )

graph2<-ddply(graph1, .(Arrangement, SeqType, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, shape=SeqType, colour=Arrangement, linetype=SeqType, group=interaction(Arrangement, SeqType)))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16,1))+
  ggtitle("item location change as a function of sequence type + \nunique target in seq + decision to organize")+
  scale_colour_manual("Item Organization", values=wes_palette(n=3, name="GrandBudapest1"))+
  scale_x_discrete("Length of Target Sequence")+
  scale_y_continuous("Distance", limits=c(0, 720), breaks=seq(0, 1000, 100))
```

```{r}
e2.org.sub<-subset(e2.org, Arrangement!="Unorganized")
arr.mod<-lmer(Distance~SeqType*Arrangement*rep.c+(1|SUBJECT), data = e2.org.sub, REML=F, na.action="na.omit",
              contrasts=list(SeqType="contr.sum", Arrangement="contr.sum"))
tab_model(arr.mod, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# seq length * arrangement
arr.mod2<-lmer(Distance~SeqType+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Pre-Organization",], 
               REML=F, na.action="na.omit", contrasts = list(SeqType="contr.sum"))
arr.mod3<-lmer(Distance~SeqType+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Post-Organization",], 
               REML=F, na.action="na.omit", contrasts = list(SeqType="contr.sum"))
tab_model(arr.mod2, arr.mod3, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# seq length * repetition
arr.mod4<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$SeqType=="Short",], 
               REML=F, na.action="na.omit")
arr.mod5<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$SeqType=="Long",], 
               REML=F, na.action="na.omit")
tab_model(arr.mod4, arr.mod5, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

# arrangement * rep.c
arr.mod6<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Pre-Organization",], 
               REML=F, na.action="na.omit")
arr.mod7<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Post-Organization",], 
               REML=F, na.action="na.omit")
tab_model(arr.mod6, arr.mod7, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

(pre- vs post-organization)

Items were located further away from the goal location pre-organization and moved closer post-organization (b = 173.99, 95% CI [167.41, 180.57], t = 51.83, p < .001)

There was a significant two-way interaction between sequence length across organizational states (b = 14.81, 95% CI [8.23, 21.39], t = 4.41, p < .001). Specifically, prior to organization, item distance did not differ as a function of sequence length (b = 8.82, 95% CI [-2.15, 19.79], t = 1.58, p = .11). However, post-organization, items tend to be placed closer to the goal location when individuals are presented with short rather than long target sequences (b = -14.81, 95% CI [-21.49, -8.13], t = 4.34, p < .001).

There was also a significant two-way interaction between repetition and sequence length (b = 6.95, 95% CI [1.55, 12.35], t = 2.52, p = .01). However, there was no relation between repetition and item distance both for short (b = 6.09, 95% CI [-8.35, 20.53], t = .83, p = .41) and long sequences (b = -7.49, 95% CI [19.03, 4.05], t = 1.27, p = .20)

Finally, there was a significant two-way interaction between organizational states and repetition (b = 17.60, 95% CI [12.24, 22.96], t = 6.44, p < .001). Prior to organization, increased repetition length was associated with increased average item distance to the goal location (b = 14.75, 95% CI [5.90, 23.61], t = 3.27, p < .001); however, post-organization, this pattern reversed, such that an increase in repetition length led to decreased average item distance (b = -15.75, 95% CI [-21.11, -10.39], t = 5.76, p < .001)


##### {.tabset}

###### (Graph of the seq length x pre/post organization beow)

```{r}
graph1<-ddply(e2.org.sub, .(SUBJECT, Arrangement, SeqType), summarize, 
              mean=mean(Distance)
              )

graph2<-ddply(graph1, .(Arrangement, SeqType), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))


ggplot(graph2, aes(x=SeqType, y=dep.avg, colour=Arrangement, group=Arrangement))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16,1))+
  ggtitle("item location change as a function of sequence type + \nunique target in seq + decision to organize")+
  scale_colour_manual("Item Organization", values=wes_palette(n=3, name="GrandBudapest1"))+
  scale_x_discrete("Length of Target Sequence")+
  scale_y_continuous("Distance", limits=c(0, 720), breaks=seq(0, 1000, 100))
```


###### (graph for the sequence length x repetition interaction)

```{r}
graph1<-ddply(e2.org.sub, .(SUBJECT, SeqType, Repetition), summarize, 
              mean=mean(Distance)
              )

graph2<-ddply(graph1, .(SeqType, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=SeqType, group=SeqType))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16,1))+
  ggtitle("item location change as a function of sequence type + \nunique target in seq + decision to organize")+
  scale_colour_manual("Item Organization", values=wes_palette(n=3, name="GrandBudapest1"))+
  scale_x_discrete("Length of Target Sequence")+
  scale_y_continuous("Distance", limits=c(0, 720), breaks=seq(0, 1000, 100))
```

###### (graph for the organization x repetition interaction)

```{r}
graph1<-ddply(e2.org.sub, .(SUBJECT, Arrangement, Repetition), summarize, 
              mean=mean(Distance)
              )

graph2<-ddply(graph1, .(Arrangement, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=Arrangement, group=Arrangement))+
  geom_point(size=3, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  scale_shape_manual(values=c(16,1))+
  ggtitle("item location change as a function of sequence type + \nunique target in seq + decision to organize")+
  scale_colour_manual("Item Organization", values=wes_palette(n=3, name="GrandBudapest1"))+
  scale_x_discrete("Length of Target Sequence")+
  scale_y_continuous("Distance", limits=c(0, 720), breaks=seq(0, 1000, 100))
```


(unorganized vs pre-organized trials)

```{r}
e2.org.sub<-subset(e2.org, Arrangement!="Post-Organization")
arr.mod<-lmer(Distance~SeqType*Arrangement*rep.c+(1|SUBJECT), data = e2.org.sub, REML=F, na.action="na.omit", 
              contrasts = list(SeqType="contr.sum", Arrangement="contr.sum"))
tab_model(arr.mod, transform = NULL, show.stat = T, p.val = "wald", digits.p = 3)

# breaking down the 3-way interaction
arr.mod2<-lmer(Distance~SeqType*rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Unorganized",], 
               REML=F, na.action="na.omit")

arr.mod3<-lmer(Distance~SeqType*rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Pre-Organization",],
               REML=F, na.action="na.omit", contrasts = list(SeqType="contr.sum"))
# had to up the iteration because of convergence issue
ss <- getME(arr.mod2,c("theta","fixef"))
arr.mod3.2 <- update(arr.mod2, start=ss, control=lmerControl(optCtrl=list(maxfun=2e4)))

tab_model(arr.mod2, arr.mod3.2, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

Overall, the initial average item distance to the goal location was closer for trials in which items were not moved compared to initial item distances for items that were later moved  (b = -47.74, 95% CI [-58.00, -37.48], t = 9.12, p < .001).

There was a two-way interaction between organizational state and sequence length (b = -9.23, 95% I [-17.12, -1.33], t = 2.29, p = .02), as well as a two-way interaction between organizational state and repetition (b = -20.47, 95% CI [-26.79, -14.15], t = 6.35, p < .001).

Importantly, there was a significant three-way interaction (b = -6.49, 95% CI [-12.73, -.07], t = 1.98, p = .047). To further understand this interaction, follow-up analyses were conducted at each level of organizational state.

For trials wherein organization was not attempted, the initial location of items did not differ as a function of sequence length (b = 17.73, 95% CI [-8.71, 36.18], t = 1.20, p = .23), but increased repetition led to a decrease in average item distance (b = -31.21, 95% CI [-43.60, -18.83], t = 4.94, p < .001). On the other hand, when items were later organized, average item distance to the goal location was shorter when presented with long target sequences than short ones (b = -22.06, 95% CI [-43.93, -.19], t = 1.98, p = .05), and was positively related to repetition length (b = 21.12, 95% CI [8.22, 34.02], t = 3.21, p < .001). There were no significant two-way interactions in either case (all p > .14)




(unorganized vs post-organization)


```{r}
e2.org.sub<-subset(e2.org, Arrangement!="Pre-Organization")
arr.mod<-lmer(Distance~SeqType*Arrangement*rep.c+(1|SUBJECT), data = e2.org.sub, REML=F, na.action="na.omit")
tab_model(arr.mod, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

Post-organization, items were placed much closer to the goal location compared to trials where organization was not attempted (b = -212.52, 95% CI [-234.80, -190.24], t = 18.70, p < .001).

Increased repetition length was associated with a decrease in average item distance to the goal lcoation (b = -30.81, 95% CI [-41.10, -20.51], t = 5.87, p < .001).

There was a two-way interaction between organization (unorganized vs. post-organization) and repetition length (b = 22.16, 95% CI [7.30, 37.02], t = 2.92, p < .001). 

More importantly, there was a significant three-way interaction (b = -30.58, 95% CI [-51.48, 9.68], t = 2.87, p < .001). For trials wherein organization was not attempted, the initial location of items did not differ as a function of sequence length (b = 17.73, 95% CI [-8.71, 36.18], t = 1.20, p = .23), but increased repetition led to a decrease in average item distance (b = -31.21, 95% CI [-43.60, -18.83], t = 4.94, p < .001). On the other hand, both sequence length (b = 33.31, 95% CI [20.34, 46.28], t = 5.03, p < .001) and repetition (b = -7.63, 95% CI [-15.27, - .003], t = 1.96, p = .05) were both significant predictors of average item distance.


```{r}
arr.mod2<-lmer(Distance~SeqType*rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Unorganized",], REML=F, na.action="na.omit")
arr.mod3<-lmer(Distance~SeqType*rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Post-Organization",], REML=F, na.action="na.omit")
tab_model(arr.mod2, arr.mod3, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)

```

More importantly, there was also a two-way interaction between repetition and sequence length (b = -18.20, 95% CI [-28.74, -7.65], t = 3.38, p < .001). Specifically, with short target sequences, repetition length did not predict average item distance (b = 7.25, 95% CI [-15.80, 1.29], t = 1.66, p < .001), where as repetition was negatively associated with item distance for long target sequences (b = -26.48, 95% CI [-32.89, -20.07], t = 8.10, p < .001).

```{r}
arr.mod4<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Post-Organization" & e2.org.sub$SeqType=="Short",], REML=F, na.action="na.omit")
arr.mod5<-lmer(Distance~rep.c+(1|SUBJECT), data = e2.org.sub[e2.org.sub$Arrangement=="Post-Organization" & e2.org.sub$SeqType=="Long",], REML=F, na.action="na.omit")
tab_model(arr.mod4, arr.mod5, transform = NULL, show.stat = T, p.val = "wald", digits.p = 2)
```

### Organizational Moves: Item-Level Organization

#### Proportion of Items Moved 



```{r}
graph1<-ddply(item2, .(SUBJECT, SeqType, Repetition), summarize, 
              mean=mean(Move.Num)
              )

graph2<-ddply(graph1, .(SeqType, Repetition), summarize,   
              dep.avg=mean(mean, na.rm=T),
              dep.sd=sd(mean, na.rm=T),
              dep.count=length(mean), 
              dep.ci=dep.sd*qt(0.975,df=dep.count-1)/sqrt(dep.count))

graph2$Repetition=factor(graph2$Repetition)

ggplot(graph2, aes(x=Repetition, y=dep.avg, colour=SeqType, group=SeqType))+
  geom_point(size=3, shape=16, position = position_dodge(0))+
  geom_errorbar(aes(ymax=dep.avg+dep.ci, 
                    ymin=dep.avg-dep.ci),
                    width=0, position = position_dodge(0))+
  geom_line()+
  theme(
    panel.background= element_rect(fill=NA), # transparent panel
    plot.background = element_rect(fill=NA, colour=NA), #transparent background
    panel.grid=element_blank(), # remove panel grid
    axis.ticks.x=element_blank(), # remove tick marks on x-axis
    axis.ticks=element_line(colour="gray70"), # change colour of tick marks
    panel.border = element_rect(fill="transparent", colour="gray70"), # change panel border colour
    legend.background = element_rect(fill = "transparent", colour = "transparent"), # change legend background
    axis.text = element_text(color="#432620"),
    legend.key = element_rect(fill = "transparent", colour = "transparent")
  )+
  ggtitle("prop. item movement as a function of sequence type + unique target in seq")+
  geom_hline(yintercept = 0.5, linetype="dotted")+
  scale_colour_manual("Sequence\nLength", values=wes_palette("Moonrise3", n=2))+
  scale_x_discrete("Repetition Length")+
  scale_y_continuous("Proportion of Items Moved", limits=c(0, 1))
```